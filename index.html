<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Player</title>
    <link
      rel="shortcut icon"
      href="https://static.tildacdn.com/tild6535-3931-4534-a462-643438616464/favicon.ico"
      type="image/x-icon"
    />
    <script>
        function createPlayer() {
          const Player = Kinescope.IframePlayer;
          return Player.create('player', {
            url: 'https://kinescope.dev/embed/0ct6PqEa3wvmhd3z4UK9C5',

            size: { width: '100%', height: 400 },

            behaviour: {
              // preload: true,
              // autoPlay: true,
              // crossOrigin: 'use-credentials',
            },

            settings: {
              // driverSettings: {
              //   hls: { playback: 'native' },
              // },
              // metrics: {
              //   interval: 2000,
              // },
            },

            playlist: [{
              drm: {
                widevine: {
                  detectRobustness: false
                }
              },
              liveSync: true
            }]
          }).then((player) => {
          console.log('player initialized');

          // player.on(Player.PlayerEvent.FullscreenChange, ({ data }) => {
          //   if (!data.isFullscreen) return;

          //   setTimeout(async () => {
          //     await player.destroy();

          //     if (!document.getElementById('player')) {
          //       const container = document.createElement('div');
          //       container.id = 'player';
          //       document.body.appendChild(container);
          //     }

          //     await createPlayer();
          //   }, 5000);
          // });
        });
      }

      function onKinescopeIframeAPIReady(Player) {
        console.log('iframe api ready', Player);
        createPlayer();
      }
    </script>
    <script
      async
      src="https://player.kinescope.dev/v2.169.0/iframe.player.js"
    ></script>
  </head>
  <body>
    <div style="display: flex; gap: 20px; padding: 20px;">
      <div id="player" style="flex: 1.5;"></div>
      <div style="flex: 2;">
        <h3 style="margin: 0 0 10px 0; color: #333;">Чат трансляции</h3>
        <iframe 
          src="https://kinescope.dev/chat/0ct6PqEa3wvmhd3z4UK9C5?token=eyJhbGciOiJSUzI1NiIsImtpZCI6InE5OGltUml1bDdxd0UyTVhDOWVoMTBoUWI1YlNuYnJOUzFMVXlXN094bnciLCJ0eXAiOiJKV1QifQ.eyJzdWIiOiJqd3QtdGVzdCIsImp0aSI6IjIzNDE0MzUiLCJpZCI6IjEiLCJ1c2VybmFtZSI6InVzZXIxIiwibmJmIjoxNzYwMDk0ODE4LCJleHAiOjE3NjU1NDg4MTgsImlhdCI6MTc2MDA5NDgxOCwiaXNzIjoiNTJkYWNmMmUtZmRlMC00ZDExLTkzNzItNjNhNGM5ZmE3MzhlIiwiYXVkIjoiY2hhdC1zZXJ2aWNlIn0.APhiliiKuGkrQ9_kk2yGtZA72sN97Td8YEhwFXaujM9h3NbOWBfNOjK6fHlCRyeEqOTvpoiefo4CRPTyk9zwEEKVLiuGfREpm-MtRYk8dvRmHEUi-l-MY582BHqUPjTsUrYN_xTDdimLzUSTW_HbA7X4JIxuwH9sH6Pb5GD7f0iK-6jltcZOTF6cGZLsglA8VDyI78Vb55tWoTxPR6-eXOZ9EGXO9oPZz7REQVE0N2slJumJwEfg_zK2Ap7PD9EetI06L0OGNiKrznDcJHl2EKwOXmzRfr9FLwWM0YJpE_4bRLmTSgSOhTnlN9nIr4r6bQkSFLC1pwJIavnPcsxuKQ" 
          frameborder="0" 
          width="100%" 
          height="400"
          style="border-radius: 8px; border: 2px solid #ccc; background-color: #f5f5f5;"
          onload="console.log('Chat iframe loaded successfully')"
          onerror="console.error('Chat iframe failed to load')">
        </iframe>
        <p style="font-size: 12px; color: #666; margin: 5px 0 0 0;">
          Если чат не загружается, проверьте консоль браузера (F12) на наличие ошибок
        </p>
      </div>
    </div>
  </body>
</html>
